#!/usr/bin/env bash

# codemux - tmux session manager for Visual Studio Code

# Usage: Add the following block to your settings.json file:
# "terminal.integrated.profiles.osx": {
#     "tmux": {
#         "path": "codemux",
#         "args": [
#             "${workspaceFolderBasename}"
#         ],
#         "icon": "terminal-tmux"
#     },
# }

TMUX=$(which tmux)
TMUX_SERVER="vscode"
CONFIG_FILE="$HOME/.config/tmux/vscode.conf"

if [ -z "$1" ]; then
    SESSION_NAME="vscode"
else
    SESSION_NAME="vscode-$1"
fi

$TMUX -L $TMUX_SERVER attach -t "$SESSION_NAME" ||\
$TMUX -L $TMUX_SERVER -f "$CONFIG_FILE" new-session -s "$SESSION_NAME"
